<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>心尘的技术博客</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/x-icon" href="/study-summary/study-summary/img/logo.jpg">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.css">
    <meta name="description" content="前端学习 学习记录 工作记录 博客收集">
    
    <link rel="preload" href="/study-summary/assets/css/0.styles.3f98af74.css" as="style"><link rel="preload" href="/study-summary/assets/js/app.15e8944e.js" as="script"><link rel="preload" href="/study-summary/assets/js/2.57a18240.js" as="script"><link rel="preload" href="/study-summary/assets/js/27.1122e22d.js" as="script"><link rel="prefetch" href="/study-summary/assets/js/10.24dfc03e.js"><link rel="prefetch" href="/study-summary/assets/js/11.2732e6be.js"><link rel="prefetch" href="/study-summary/assets/js/12.1beb8ac9.js"><link rel="prefetch" href="/study-summary/assets/js/13.84b3918b.js"><link rel="prefetch" href="/study-summary/assets/js/14.09979e98.js"><link rel="prefetch" href="/study-summary/assets/js/15.a38ad7d5.js"><link rel="prefetch" href="/study-summary/assets/js/16.02d2b861.js"><link rel="prefetch" href="/study-summary/assets/js/17.00f210f1.js"><link rel="prefetch" href="/study-summary/assets/js/18.6db3c126.js"><link rel="prefetch" href="/study-summary/assets/js/19.c9ec410a.js"><link rel="prefetch" href="/study-summary/assets/js/20.b15749ef.js"><link rel="prefetch" href="/study-summary/assets/js/21.bf69121d.js"><link rel="prefetch" href="/study-summary/assets/js/22.6bd85aad.js"><link rel="prefetch" href="/study-summary/assets/js/23.80fc7b24.js"><link rel="prefetch" href="/study-summary/assets/js/24.9e9ff6ec.js"><link rel="prefetch" href="/study-summary/assets/js/25.4687a6e4.js"><link rel="prefetch" href="/study-summary/assets/js/26.1b24092a.js"><link rel="prefetch" href="/study-summary/assets/js/28.e7ec9fc1.js"><link rel="prefetch" href="/study-summary/assets/js/29.7febf863.js"><link rel="prefetch" href="/study-summary/assets/js/3.edb5f675.js"><link rel="prefetch" href="/study-summary/assets/js/30.7126ce43.js"><link rel="prefetch" href="/study-summary/assets/js/31.c66dea1e.js"><link rel="prefetch" href="/study-summary/assets/js/32.70b6d4e7.js"><link rel="prefetch" href="/study-summary/assets/js/33.30ed9583.js"><link rel="prefetch" href="/study-summary/assets/js/34.255aa06d.js"><link rel="prefetch" href="/study-summary/assets/js/35.3d3fe8b5.js"><link rel="prefetch" href="/study-summary/assets/js/36.b4a11160.js"><link rel="prefetch" href="/study-summary/assets/js/37.4a3677f0.js"><link rel="prefetch" href="/study-summary/assets/js/38.86090bd8.js"><link rel="prefetch" href="/study-summary/assets/js/39.150e65bf.js"><link rel="prefetch" href="/study-summary/assets/js/4.2c857f25.js"><link rel="prefetch" href="/study-summary/assets/js/40.339adaa9.js"><link rel="prefetch" href="/study-summary/assets/js/41.4c03f2d1.js"><link rel="prefetch" href="/study-summary/assets/js/42.3aee7993.js"><link rel="prefetch" href="/study-summary/assets/js/43.ec67d5e3.js"><link rel="prefetch" href="/study-summary/assets/js/44.97feb67c.js"><link rel="prefetch" href="/study-summary/assets/js/45.a6abc1b6.js"><link rel="prefetch" href="/study-summary/assets/js/46.96ac5374.js"><link rel="prefetch" href="/study-summary/assets/js/47.b4976af5.js"><link rel="prefetch" href="/study-summary/assets/js/48.7200a687.js"><link rel="prefetch" href="/study-summary/assets/js/49.d0ef73da.js"><link rel="prefetch" href="/study-summary/assets/js/5.0b5fb5ab.js"><link rel="prefetch" href="/study-summary/assets/js/50.6f6eb6bf.js"><link rel="prefetch" href="/study-summary/assets/js/51.702dd036.js"><link rel="prefetch" href="/study-summary/assets/js/52.25a57413.js"><link rel="prefetch" href="/study-summary/assets/js/6.974b7a8f.js"><link rel="prefetch" href="/study-summary/assets/js/7.df30ca24.js"><link rel="prefetch" href="/study-summary/assets/js/8.1fbbb5d1.js"><link rel="prefetch" href="/study-summary/assets/js/9.d307cbb3.js">
    <link rel="stylesheet" href="/study-summary/assets/css/0.styles.3f98af74.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/study-summary/" class="home-link router-link-active"><img src="/study-summary/img/logo.jpg" alt="心尘的技术博客" class="logo"> <span class="site-name can-hide">心尘的技术博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/study-summary/markdown/" class="nav-link">
  markdown语法
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="vue生态相关" class="dropdown-title"><span class="title">vue生态相关</span> <span class="arrow down"></span></button> <button type="button" aria-label="vue生态相关" class="mobile-dropdown-title"><span class="title">vue生态相关</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/study-summary/vue/vue-common/" class="nav-link">
  vue常用技巧
</a></li><li class="dropdown-item"><!----> <a href="/study-summary/vue/vuex/" class="nav-link">
  vuex相关
</a></li><li class="dropdown-item"><!----> <a href="/study-summary/vue/vue-router/" class="nav-link">
  vue-router相关
</a></li><li class="dropdown-item"><!----> <a href="/study-summary/vue/vue-resource/" class="nav-link">
  vue相关
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="总结" class="dropdown-title"><span class="title">总结</span> <span class="arrow down"></span></button> <button type="button" aria-label="总结" class="mobile-dropdown-title"><span class="title">总结</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/study-summary/summary/workSummary/" class="nav-link">
  工作积累
</a></li><li class="dropdown-item"><!----> <a href="/study-summary/summary/project/" class="nav-link router-link-active">
  项目心得
</a></li><li class="dropdown-item"><!----> <a href="/study-summary/summary/blog/" class="nav-link">
  博客收集
</a></li></ul></div></div> <a href="https://github.com/zhangjunlin6666/study-summary" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/study-summary/markdown/" class="nav-link">
  markdown语法
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="vue生态相关" class="dropdown-title"><span class="title">vue生态相关</span> <span class="arrow down"></span></button> <button type="button" aria-label="vue生态相关" class="mobile-dropdown-title"><span class="title">vue生态相关</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/study-summary/vue/vue-common/" class="nav-link">
  vue常用技巧
</a></li><li class="dropdown-item"><!----> <a href="/study-summary/vue/vuex/" class="nav-link">
  vuex相关
</a></li><li class="dropdown-item"><!----> <a href="/study-summary/vue/vue-router/" class="nav-link">
  vue-router相关
</a></li><li class="dropdown-item"><!----> <a href="/study-summary/vue/vue-resource/" class="nav-link">
  vue相关
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="总结" class="dropdown-title"><span class="title">总结</span> <span class="arrow down"></span></button> <button type="button" aria-label="总结" class="mobile-dropdown-title"><span class="title">总结</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/study-summary/summary/workSummary/" class="nav-link">
  工作积累
</a></li><li class="dropdown-item"><!----> <a href="/study-summary/summary/project/" class="nav-link router-link-active">
  项目心得
</a></li><li class="dropdown-item"><!----> <a href="/study-summary/summary/blog/" class="nav-link">
  博客收集
</a></li></ul></div></div> <a href="https://github.com/zhangjunlin6666/study-summary" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>工作积累</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>项目心得</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/study-summary/summary/project/" aria-current="page" class="sidebar-link">主题</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>后台管理系统</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/study-summary/summary/project/backEndSystem/vue.html" aria-current="page" class="active sidebar-link">vue技术栈</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/study-summary/summary/project/backEndSystem/vue.html#路由无限嵌套处理" class="sidebar-link">路由无限嵌套处理</a></li><li class="sidebar-sub-header"><a href="/study-summary/summary/project/backEndSystem/vue.html#空页面" class="sidebar-link">空页面</a></li><li class="sidebar-sub-header"><a href="/study-summary/summary/project/backEndSystem/vue.html#路由扁平化" class="sidebar-link">路由扁平化</a></li><li class="sidebar-sub-header"><a href="/study-summary/summary/project/backEndSystem/vue.html#面包屑的处理" class="sidebar-link">面包屑的处理</a></li><li class="sidebar-sub-header"><a href="/study-summary/summary/project/backEndSystem/vue.html#动态路由" class="sidebar-link">动态路由</a></li><li class="sidebar-sub-header"><a href="/study-summary/summary/project/backEndSystem/vue.html#页面效果" class="sidebar-link">页面效果</a></li></ul></li></ul></section></li></ul></section></li><li><a href="/study-summary/summary/blog/" class="sidebar-link">技术博客收集</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="后台管理系统"><a href="#后台管理系统" class="header-anchor">#</a> 后台管理系统</h1> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>该模块记录在后台管理系统开发过程对于路由无限嵌套、面包屑以及动态路由处理的心得。</p></div> <h2 id="路由无限嵌套处理"><a href="#路由无限嵌套处理" class="header-anchor">#</a> 路由无限嵌套处理</h2> <p>在开发后台管理系统过程中，常常会遇到路由无限嵌套的情况，这时候对于我们的路由配置文件来说，有多少个children，理论上来说我们就要嵌套多少个router-view，这样的话就显得很麻烦，那么有没有更优雅的处理方式呢？下面就介绍两种路由无限嵌套的处理方式。</p> <h2 id="空页面"><a href="#空页面" class="header-anchor">#</a> 空页面</h2> <p>定义一个只有router-view组件的空白页面。</p> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fade<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>keep-alive</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-view</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>keep-alive</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transition</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'empty'</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>less<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
  <span class="token selector">.fade-enter-active,
  .fade-leave-active</span> <span class="token punctuation">{</span>
    <span class="token property">transition</span><span class="token punctuation">:</span> opacity .3s
  <span class="token punctuation">}</span>

  <span class="token selector">.fade-enter,
  .fade-leave-active</span> <span class="token punctuation">{</span>
    <span class="token property">opacity</span><span class="token punctuation">:</span> 0
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>路由配置</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">/*
  如果有需要嵌套的路由，就加一个component为empty的路由，这样就可以达到路由无限嵌套的效果
*/</span>

<span class="token keyword">import</span> empty <span class="token keyword">from</span> <span class="token string">&quot;@/components/empty&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
    path<span class="token operator">:</span> <span class="token string">&quot;/yunyingsoftware&quot;</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span><span class="token string">&quot;YunyingSoftware&quot;</span><span class="token punctuation">,</span>
    component<span class="token operator">:</span> Layout<span class="token punctuation">,</span>
    redirect<span class="token operator">:</span><span class="token string">&quot;/yunyingsoftware/install&quot;</span><span class="token punctuation">,</span>
    meta<span class="token operator">:</span> <span class="token punctuation">{</span>
      title<span class="token operator">:</span><span class="token string">&quot;云影软件版本管理&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    children<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            path<span class="token operator">:</span> <span class="token string">&quot;install&quot;</span><span class="token punctuation">,</span>
            name<span class="token operator">:</span> <span class="token string">&quot;YunYingInstall&quot;</span><span class="token punctuation">,</span>
            component<span class="token operator">:</span> empty<span class="token punctuation">,</span>
            redirect<span class="token operator">:</span><span class="token string">&quot;/yunyingsoftware/install/list&quot;</span><span class="token punctuation">,</span>
            meta<span class="token operator">:</span> <span class="token punctuation">{</span>
                title<span class="token operator">:</span> <span class="token string">&quot;安装包管理&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            children<span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token punctuation">{</span>
                    path<span class="token operator">:</span> <span class="token string">&quot;list&quot;</span><span class="token punctuation">,</span>
                    name<span class="token operator">:</span> <span class="token string">&quot;YunYingInstallList&quot;</span><span class="token punctuation">,</span>
                    <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&quot;@/views/yunying-software/install/list&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    meta<span class="token operator">:</span> <span class="token punctuation">{</span>
                        title<span class="token operator">:</span> <span class="token string">&quot;安装包管理&quot;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">{</span>
                    path<span class="token operator">:</span> <span class="token string">&quot;upload&quot;</span><span class="token punctuation">,</span>
                    <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&quot;@/views/yunying-software/install/upload&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    name<span class="token operator">:</span> <span class="token string">&quot;YunYingInstallUpload&quot;</span><span class="token punctuation">,</span>
                    hidden<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                    meta<span class="token operator">:</span> <span class="token punctuation">{</span>
                        title<span class="token operator">:</span> <span class="token string">&quot;上传安装包&quot;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br></div></div><h2 id="路由扁平化"><a href="#路由扁平化" class="header-anchor">#</a> 路由扁平化</h2> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>
<span class="token comment">/**
 *  routes该参数为路由配置数组，最终处理的结果是让二级菜单下的所有菜单与二级菜单同级，
    这样就解决了路由的无限嵌套，菜单的隐藏在meta字段中设置，比喻hidden：true
 */</span>

<span class="token keyword">function</span> <span class="token function">transRoutes</span><span class="token punctuation">(</span><span class="token parameter">routes</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> realRouters <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  routes<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>item<span class="token punctuation">.</span>children <span class="token operator">&amp;&amp;</span> item<span class="token punctuation">.</span>children<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> object <span class="token operator">=</span> <span class="token punctuation">{</span>
        path<span class="token operator">:</span> item<span class="token punctuation">.</span>path<span class="token punctuation">,</span>
        name<span class="token operator">:</span> item<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
        component<span class="token operator">:</span> item<span class="token punctuation">.</span>component<span class="token punctuation">,</span>
        meta<span class="token operator">:</span> item<span class="token punctuation">.</span>meta<span class="token punctuation">,</span>
        children<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token function">findRoute</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> object<span class="token punctuation">.</span>children<span class="token punctuation">)</span><span class="token punctuation">;</span>
      realRouters<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      realRouters<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> realRouters<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">findRoute</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> children</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  item<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">ite</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
      path<span class="token operator">:</span> ite<span class="token punctuation">.</span>path<span class="token punctuation">,</span>
      name<span class="token operator">:</span> ite<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
      component<span class="token operator">:</span> ite<span class="token punctuation">.</span>component<span class="token punctuation">,</span>
      meta<span class="token operator">:</span> ite<span class="token punctuation">.</span>meta
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    children<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>ite<span class="token punctuation">.</span>children <span class="token operator">&amp;&amp;</span> ite<span class="token punctuation">.</span>children<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">findRoute</span><span class="token punctuation">(</span>ite<span class="token punctuation">,</span> children<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span>
  transRoutes
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><h2 id="面包屑的处理"><a href="#面包屑的处理" class="header-anchor">#</a> 面包屑的处理</h2> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">/*
  入参：
    route为当前路由对象
    routes为路由配置对象
  
  函数调用：
    在面包屑组件的watch中监听路由变化，调用getBreadCrumbList方法

  返回值：
    返回值为一个数组，在页面中通过v-for循环该数组即可得到面包屑

*/</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">getBreadCrumbList</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">route<span class="token punctuation">,</span> routes</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>sessionStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">&quot;breadCrumbList&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> breadCrumbList <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>sessionStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">&quot;breadCrumbList&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    sessionStorage<span class="token punctuation">.</span><span class="token function">removeItem</span><span class="token punctuation">(</span><span class="token string">&quot;breadCrumbList&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> breadCrumbList<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">let</span> NameArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
    hasParentId <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">loop</span><span class="token punctuation">(</span><span class="token parameter">routes<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> routes<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>item<span class="token punctuation">.</span>name <span class="token operator">===</span> route<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          item<span class="token punctuation">.</span>query <span class="token operator">=</span> route<span class="token punctuation">.</span>query<span class="token punctuation">;</span>
          NameArr <span class="token operator">=</span> NameArr<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">;</span>
          NameArr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>children<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          NameArr<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> item<span class="token punctuation">;</span>
          <span class="token keyword">return</span> <span class="token function">loop</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>children<span class="token punctuation">,</span> index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>routes<span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> breadCrumbList <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>sessionStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">&quot;breadCrumbList&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>breadCrumbList<span class="token operator">&amp;&amp;</span>breadCrumbList<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">{</span>
    NameArr<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span> <span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      breadCrumbList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span> <span class="token parameter">it</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>name <span class="token operator">===</span> it<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">{</span>
          item<span class="token punctuation">.</span>query <span class="token operator">=</span> it<span class="token punctuation">.</span>query
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  sessionStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">&quot;breadCrumbList&quot;</span><span class="token punctuation">,</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>NameArr<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> hasParentId <span class="token operator">?</span> NameArr <span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br></div></div><h2 id="动态路由"><a href="#动态路由" class="header-anchor">#</a> 动态路由</h2> <p>动态路由配置模块，动态路由在配置的时候，前端需要给管理员提供一个json文件，该文件输出的是一个路由配置，当有新添加的路由时，需要及时的与管理同步并更新json</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">/*
  /module/affair module下的affair
*/</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token comment">// 教务管理 —— 课程管理</span>
  CourseList<span class="token operator">:</span> <span class="token punctuation">{</span>
    component<span class="token operator">:</span> <span class="token string">&quot;import你的组件&quot;</span><span class="token punctuation">,</span> <span class="token comment">// CourseList对应的组件</span>
    children<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        path<span class="token operator">:</span> <span class="token string">&quot;/affair/courseManagement/add&quot;</span><span class="token punctuation">,</span>
        name<span class="token operator">:</span> <span class="token string">&quot;CourseAdd&quot;</span><span class="token punctuation">,</span>
        component<span class="token operator">:</span> <span class="token string">&quot;import你的组件&quot;</span><span class="token punctuation">,</span>
        meta<span class="token operator">:</span> <span class="token punctuation">{</span>
          title<span class="token operator">:</span> <span class="token string">&quot;添加课程&quot;</span><span class="token punctuation">,</span>
          hideInMenu<span class="token operator">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        path<span class="token operator">:</span> <span class="token string">&quot;/affair/courseManagement/detail&quot;</span><span class="token punctuation">,</span>
        name<span class="token operator">:</span> <span class="token string">&quot;CourseDetail&quot;</span><span class="token punctuation">,</span>
        component<span class="token operator">:</span> <span class="token string">&quot;import你的组件&quot;</span><span class="token punctuation">,</span><span class="token punctuation">,</span>
        meta<span class="token operator">:</span> <span class="token punctuation">{</span>
          title<span class="token operator">:</span> <span class="token string">&quot;课程详情&quot;</span><span class="token punctuation">,</span>
          hideInMenu<span class="token operator">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        children<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            path<span class="token operator">:</span> <span class="token string">&quot;/affair/courseManagement/prepareLessonsPreclass&quot;</span><span class="token punctuation">,</span>
            name<span class="token operator">:</span> <span class="token string">&quot;PrepareLessonsPreclass&quot;</span><span class="token punctuation">,</span>
            component<span class="token operator">:</span> <span class="token string">&quot;import你的组件&quot;</span><span class="token punctuation">,</span><span class="token punctuation">,</span>
            meta<span class="token operator">:</span> <span class="token punctuation">{</span>
              title<span class="token operator">:</span> <span class="token string">&quot;备课-课前测&quot;</span><span class="token punctuation">,</span>
              hideInMenu<span class="token operator">:</span> <span class="token boolean">true</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">// 教务管理 —— 课程表</span>
  CourseTableList<span class="token operator">:</span> <span class="token punctuation">{</span>
    component<span class="token operator">:</span> courseTableList
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">// 教务管理 —— 成绩分析</span>
  AffairGradeList<span class="token operator">:</span> <span class="token punctuation">{</span>
    component<span class="token operator">:</span> gradeList<span class="token punctuation">,</span>
    children<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
      path<span class="token operator">:</span> <span class="token string">&quot;/affair/grade/detail&quot;</span><span class="token punctuation">,</span>
      name<span class="token operator">:</span> <span class="token string">&quot;AffairGradeDetail&quot;</span><span class="token punctuation">,</span>
      component<span class="token operator">:</span> gradeDetail<span class="token punctuation">,</span>
      meta<span class="token operator">:</span> <span class="token punctuation">{</span>
        title<span class="token operator">:</span> <span class="token string">&quot;成绩分析详情&quot;</span><span class="token punctuation">,</span>
        hideInMenu<span class="token operator">:</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br></div></div><p>不需要权限的路由配置模块</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> affairList <span class="token keyword">from</span> <span class="token string">&quot;./module/affair&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">Login</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&quot;@/components/login.vue&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 登录页</span>
      <span class="token function-variable function">Error404</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&quot;@/components/pages/error-page/404.vue&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 404页面</span>
      <span class="token function-variable function">Index</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&quot;@/components/index.vue&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 欢迎页面</span>
      <span class="token function-variable function">Loyon</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&quot;@/components/loyon.vue&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 布局页</span>

<span class="token keyword">const</span> route404 <span class="token operator">=</span> <span class="token punctuation">{</span>
  path<span class="token operator">:</span> <span class="token string">&quot;*&quot;</span><span class="token punctuation">,</span>
  name<span class="token operator">:</span> <span class="token string">&quot;error_404&quot;</span><span class="token punctuation">,</span>
  meta<span class="token operator">:</span> <span class="token punctuation">{</span>
    hideInMenu<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    title<span class="token operator">:</span> <span class="token string">&quot;404&quot;</span><span class="token punctuation">,</span>
    noChildren<span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  component<span class="token operator">:</span> Error404
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 动态生成欢迎页路由配置</span>
<span class="token keyword">function</span> <span class="token function">routeIndex</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    path<span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">Index</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    component<span class="token operator">:</span> Index<span class="token punctuation">,</span>
    meta<span class="token operator">:</span> <span class="token punctuation">{</span>
      title<span class="token operator">:</span> <span class="token string">&quot;首页&quot;</span><span class="token punctuation">,</span>
      hideInMenu<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      noChildren<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
  

<span class="token comment">// 不需要权限的路由</span>
<span class="token keyword">const</span> constantRoutes <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    path<span class="token operator">:</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">&quot;Login&quot;</span><span class="token punctuation">,</span>
    component<span class="token operator">:</span> Login<span class="token punctuation">,</span>
    meta<span class="token operator">:</span> <span class="token punctuation">{</span>
      title<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">腾跃双师|登录</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
      hideInMenu<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> <span class="token comment">// 当没有角色时，即用户登录没有菜单，此时应显示欢迎页</span>
    path<span class="token operator">:</span> <span class="token string">&quot;/welcome&quot;</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">&quot;Welcome&quot;</span><span class="token punctuation">,</span>
    component<span class="token operator">:</span> Loyon<span class="token punctuation">,</span>
    meta<span class="token operator">:</span> <span class="token punctuation">{</span>
      hideInMenu<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    children<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        path<span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
        name<span class="token operator">:</span> <span class="token string">&quot;WelcomeIndex&quot;</span><span class="token punctuation">,</span>
        component<span class="token operator">:</span> Index<span class="token punctuation">,</span>
        meta<span class="token operator">:</span> <span class="token punctuation">{</span>
          title<span class="token operator">:</span> <span class="token string">&quot;欢迎使用双师课堂管理系统&quot;</span><span class="token punctuation">,</span>
          hideInMenu<span class="token operator">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// 路由对应的路由表，根据后端返回的name值来匹配组件，因此，所以路由的name值不能重复，</span>
<span class="token keyword">const</span> routerMap <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>affairList
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token punctuation">{</span>
  constantRoutes<span class="token punctuation">,</span>
  routerMap<span class="token punctuation">,</span>
  route404<span class="token punctuation">,</span>
  routeIndex<span class="token punctuation">,</span>
  Loyon
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br></div></div><p>开发中路由添加</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/**
 * 开发配置路由 自行在devRouters中添加 需要配置的路由其他地方不需要动
 * @param {routers} 入参为请求的菜单数组
 */</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">routers</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> devRouters <span class="token operator">=</span> <span class="token punctuation">{</span>
    Affair<span class="token operator">:</span> <span class="token punctuation">{</span>
      router<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          meta<span class="token operator">:</span> <span class="token punctuation">{</span> title<span class="token operator">:</span> <span class="token string">&quot;协议管理&quot;</span><span class="token punctuation">,</span> icon<span class="token operator">:</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
          name<span class="token operator">:</span> <span class="token string">&quot;agreement&quot;</span><span class="token punctuation">,</span>
          path<span class="token operator">:</span> <span class="token string">&quot;/operate/agreement&quot;</span><span class="token punctuation">,</span>
          children<span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
              meta<span class="token operator">:</span> <span class="token punctuation">{</span> title<span class="token operator">:</span> <span class="token string">&quot;合作协议管理&quot;</span><span class="token punctuation">,</span> icon<span class="token operator">:</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
              name<span class="token operator">:</span> <span class="token string">&quot;cooperation&quot;</span><span class="token punctuation">,</span>
              path<span class="token operator">:</span> <span class="token string">&quot;/operate/agreement/cooperation&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
              meta<span class="token operator">:</span> <span class="token punctuation">{</span> title<span class="token operator">:</span> <span class="token string">&quot;补充协议管理&quot;</span><span class="token punctuation">,</span> icon<span class="token operator">:</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
              name<span class="token operator">:</span> <span class="token string">&quot;supplementary&quot;</span><span class="token punctuation">,</span>
              path<span class="token operator">:</span> <span class="token string">&quot;/operate/agreement/supplementary&quot;</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  routers<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>devRouters<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">itm</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>itm <span class="token operator">==</span> item<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> id <span class="token operator">=</span> item<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
        <span class="token keyword">const</span> childrenId <span class="token operator">=</span> item<span class="token punctuation">.</span>children<span class="token punctuation">[</span>item<span class="token punctuation">.</span>children<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>id<span class="token punctuation">;</span>
        devRouters<span class="token punctuation">[</span>itm<span class="token punctuation">]</span><span class="token punctuation">.</span>router<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">it<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          item<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
            Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span>id<span class="token operator">:</span> <span class="token function">Number</span><span class="token punctuation">(</span>childrenId<span class="token punctuation">)</span> <span class="token operator">+</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> parent_id<span class="token operator">:</span> id<span class="token punctuation">}</span><span class="token punctuation">,</span>it<span class="token punctuation">)</span>
          <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> routers<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><p>在路由全局守卫beforeEnter中的处理</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/*
  对于刷新页面动态菜单丢失的问题，可以有两种处理方式
  1、通过在beforeEnter中进行设置，即每次跳转路由时，都会获取菜单
  2、在登录时直接请求菜单接口，通过vuex与localstorage持久化实现

  这里采用的是第一中方案
*/</span>

<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Router <span class="token keyword">from</span> <span class="token string">&quot;vue-router&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> LoadingBar<span class="token punctuation">,</span> Message <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;view-design&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> constantRoutes<span class="token punctuation">,</span> routerMap<span class="token punctuation">,</span> route404<span class="token punctuation">,</span> Loyon<span class="token punctuation">,</span> routeIndex <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./routes&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> transRoutes <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./transRoutes&quot;</span><span class="token punctuation">;</span> <span class="token comment">// 路由扁平化的js处理程序</span>
<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">&quot;@/vuex/index&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Cookie <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@/api/cookie.js&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> concatDevTestRouters <span class="token keyword">from</span> <span class="token string">'./concatDevTestRouters'</span><span class="token punctuation">;</span>

Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Router<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  mode<span class="token operator">:</span> <span class="token string">&quot;hash&quot;</span><span class="token punctuation">,</span>
  routes<span class="token operator">:</span> constantRoutes
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

router<span class="token punctuation">.</span><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> <span class="token keyword">from</span><span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> token <span class="token operator">=</span> <span class="token function">Cookie</span><span class="token punctuation">(</span><span class="token string">&quot;AUTH_TOCKEN&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        loginName <span class="token operator">=</span> <span class="token string">&quot;Login&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>token<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>to<span class="token punctuation">.</span>name <span class="token operator">!==</span> loginName<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token function">next</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// 这里是动态路由逻辑</span>
    <span class="token keyword">const</span> sideMenuListForStore <span class="token operator">=</span> store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>sideMenuList
    <span class="token comment">// 判断store中是否存在sideMenuList，没有就请求</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>sideMenuListForStore<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span>sideMenuListForStore<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token comment">// user/getSideMenu为请求当前用户所拥有的菜单权限action，数据中的name与当前路由对象的name一一对应，并且要惟一</span>
      store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'user/getSideMenu'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">sideMenuList</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// 递归菜单，根据routerMap匹配每个路由的component属性</span>
        <span class="token keyword">function</span> <span class="token function">deep</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          arr<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
             <span class="token comment">// 对于动态插入进来的404和欢迎页不需要做匹配操作</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>item<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>noChildren<span class="token punctuation">)</span><span class="token punctuation">{</span>
              <span class="token keyword">if</span><span class="token punctuation">(</span>routerMap<span class="token punctuation">[</span>item<span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                item<span class="token punctuation">.</span>meta <span class="token operator">=</span> <span class="token punctuation">{</span>
                  <span class="token operator">...</span>routerMap<span class="token punctuation">[</span>item<span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span>meta<span class="token punctuation">,</span>
                  <span class="token operator">...</span>item<span class="token punctuation">.</span>meta
                <span class="token punctuation">}</span><span class="token punctuation">;</span>
                <span class="token comment">// routerMap的key与菜单的name对应，value为{ component: A, children: []}</span>
                item<span class="token punctuation">.</span>component <span class="token operator">=</span> routerMap<span class="token punctuation">[</span>item<span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span>component<span class="token punctuation">;</span>
                 <span class="token comment">// 如果有children递归匹配componet</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>children <span class="token operator">&amp;&amp;</span> item<span class="token punctuation">.</span>children<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">{</span>
                  <span class="token function">deep</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>children<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                  <span class="token comment">/* sideMenuList只包含菜单列表，而不包括如何添加、编辑等页面，
                    所以这里需要手动添加，通过routerMap[key]中是否包含children来判断，
                    比喻：
                      routerMap = {
                        system: system,
                        children: []
                      }
                  */</span>
                  <span class="token keyword">if</span><span class="token punctuation">(</span>routerMap<span class="token punctuation">[</span>item<span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span>children<span class="token punctuation">)</span><span class="token punctuation">{</span>
                    item<span class="token punctuation">.</span>children <span class="token operator">=</span> routerMap<span class="token punctuation">[</span>item<span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span>children<span class="token punctuation">;</span>
                  <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>

        <span class="token comment">/*
          处理开发中路由，动态路由需要后端在数据库中写入，在开发过程中前端很受限制
          所以需要在代码中混入开发中的路由，待上线时，在concatDevTestRouters中
          删除不必要的路由即可
        */</span>
        sideMenuList <span class="token operator">=</span> <span class="token function">concatDevTestRouters</span><span class="token punctuation">(</span>sideMenuList<span class="token punctuation">)</span>


        sideMenuList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token comment">// 给每个模块的根路径添加component属性，即布局组件</span>
          item<span class="token punctuation">.</span>component <span class="token operator">=</span> Loyon<span class="token punctuation">;</span>
          <span class="token comment">// 给每个根路径的children添加欢迎页</span>
          item<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">unshift</span><span class="token punctuation">(</span><span class="token function">routeIndex</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span>
          <span class="token comment">// 递归菜单的children，添加component属性</span>
          <span class="token function">deep</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>children<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token comment">// 需要将404添加到路由配置的最后一项</span>
        sideMenuList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>route404<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 在store中存储sidemenu</span>
        store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;user/setSideMenu&quot;</span><span class="token punctuation">,</span> sideMenuList<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// transRoutes扁平化路由，router.addRoutes动态加载</span>
        router<span class="token punctuation">.</span><span class="token function">addRoutes</span><span class="token punctuation">(</span><span class="token function">transRoutes</span><span class="token punctuation">(</span>sideMenuList<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span>to<span class="token punctuation">,</span> replace<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        Message<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">/*
        emptyRoutePath是一个过渡路由path，在store定义
          例如：/$transition-path，切记/不能丢

          作用：
            当在路由的全局钩子中获取动态路由后，由于是动态、异步加载路由配置，所以不知道具体跳转哪个地址，
            通过一个过渡地址进行跳转，触发全局路由拦截钩子，让页面跳转至一个不存在的地址触发全局钩子，
            从而跳转至sideMenuList的第一项path对应的页面；

            this.$router.push(this.$store.state.emptyRoutePath);
      */</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>to<span class="token punctuation">.</span>path <span class="token operator">===</span> store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>emptyRoutePath<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">// 当请求菜单数组为[]时，只有一个路由配置，即404的配置，这是在if中push进去的404</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>sideMenuListForStore<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">{</span> path<span class="token operator">:</span> <span class="token string">&quot;/welcome&quot;</span><span class="token punctuation">,</span> replace<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          <span class="token comment">// 默认跳转sideMenuListForStore的第一项</span>
          <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">{</span> path<span class="token operator">:</span> sideMenuListForStore<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>path<span class="token punctuation">,</span> replace<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// 动态修改标题</span>
        document<span class="token punctuation">.</span>title <span class="token operator">=</span> to<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>title<span class="token punctuation">;</span>
        LoadingBar<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//当有用户权限的时候，说明所有可访问路由已生成，如访问没权限的全面会自动进入404页面</span>
        <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>



<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

router<span class="token punctuation">.</span><span class="token function">afterEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  LoadingBar<span class="token punctuation">.</span><span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> router<span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br></div></div><h2 id="页面效果"><a href="#页面效果" class="header-anchor">#</a> 页面效果</h2> <p><a data-fancybox="" title="Alt text" href="/img/showPage.png"><img src="/img/showPage.png" alt="Alt text" title="页面效果"></a></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/zhangjunlin6666/study-summary/edit/master/docs/summary/project/backEndSystem/vue.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">6/16/2020, 9:55:15 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/study-summary/summary/project/" class="prev router-link-active">
        主题
      </a></span> <span class="next"><a href="/study-summary/summary/blog/">
        技术博客收集
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/study-summary/assets/js/app.15e8944e.js" defer></script><script src="/study-summary/assets/js/2.57a18240.js" defer></script><script src="/study-summary/assets/js/27.1122e22d.js" defer></script>
  </body>
</html>
